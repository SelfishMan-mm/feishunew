# 飞书多维表格数据同步工具 - 使用指南

## 📖 工具简介

飞书多维表格数据同步工具是一个专业的数据复制和同步解决方案，支持在飞书多维表格之间进行智能数据传输。工具提供四种操作模式，满足从简单复制到复杂数据处理的各种需求。

### 🎯 核心功能

- **智能差异分析**：自动对比源表格和目标表格的数据差异
- **灵活字段映射**：支持自动匹配和手动配置字段对应关系
- **高级数据筛选**：多条件筛选，精确控制复制范围
- **可视化进度显示**：实时进度条和详细操作日志
- **安全操作机制**：预览确认和操作取消功能

---

## 🚀 快速开始

### 第一步：获取授权信息

#### 1.1 获取 PersonalBaseToken

1. 打开飞书多维表格，进入要操作的 Base
2. 点击右上角 **设置** → **高级设置** → **PersonalBaseToken**
3. 点击 **生成新 Token**，复制生成的 Token（格式：`patXXXXXXXXXX`）
4. **重要**：每个 Base 都有独立的 Token，请确保使用正确的 Token

#### 1.2 获取 BaseId（自动）

- 工具会自动从当前页面 URL 中提取 BaseId
- 如果无法自动获取，会使用默认值

### 第二步：配置工具

1. 在工具界面输入 PersonalBaseToken
2. 点击 **🔍 测试授权** 验证 Token 有效性
3. 授权成功后，表格选择和操作模式区域会自动显示

---

## 🎛️ 四种操作模式详解

### 1. 🔍 预览差异模式（推荐新手）

**适用场景**：

- 第一次使用工具
- 需要确认数据变化情况
- 重要数据的安全操作

**操作步骤**：

1. 选择源表格和目标表格
2. 选择主键字段（用于记录匹配）
3. 选择"预览差异"模式
4. 点击 **🔍 开始分析**
5. 查看差异分析结果
6. 确认无误后点击 **✅ 确认执行复制**

**差异结果解读**：

- **新增记录**（绿色）：源表有，目标表没有的数据
- **删除记录**（红色）：目标表有，源表没有的数据
- **修改记录**（黄色）：两表都有，但内容不同的数据
- **相同记录**（蓝色）：两表完全一致的数据

### 2. 🚀 直接复制模式（适合熟练用户）

**适用场景**：

- 确定要复制所有数据
- 快速批量处理
- 熟悉工具操作的用户

**操作步骤**：

1. 选择源表格和目标表格
2. 选择"直接复制"模式
3. 点击 **🚀 开始复制**
4. 确认操作后等待完成

**特点**：

- 跳过差异分析，直接执行
- 带进度条显示
- 支持中途取消操作

### 3. 🎯 字段映射模式（处理复杂场景）

**适用场景**：

- 源表格和目标表格字段名不完全匹配
- 需要自定义字段对应关系
- 数据结构转换

**操作步骤**：

1. 选择源表格和目标表格
2. 选择"字段映射"模式
3. 点击 **🎯 配置映射**
4. 在映射界面中：
   - 查看自动匹配的字段（绿色"已映射"标识）
   - 手动调整未匹配的字段（红色"未映射"标识）
   - 使用下拉菜单选择目标字段
5. 点击 **🚀 使用映射执行复制**

**映射规则**：

- 工具会自动匹配同名字段
- 可以手动调整任何字段的对应关系
- 未映射的字段不会被复制

### 4. 🔧 高级筛选模式（精确数据处理）

**适用场景**：

- 只需要复制满足特定条件的数据
- 按状态、时间、类别等筛选
- 精确的数据子集处理

**操作步骤**：

1. 选择源表格和目标表格
2. 选择"高级筛选"模式
3. 点击 **🔧 配置筛选**
4. 添加筛选条件：
   - 选择字段
   - 选择操作符
   - 输入筛选值（如需要）
   - 点击 **➕ 添加条件**
5. 点击 **🔍 预览筛选结果** 查看匹配记录数
6. 点击 **🚀 执行筛选复制**

**支持的筛选操作符**：

- **等于**：字段值完全匹配
- **包含**：字段值包含指定文本
- **开头是**：字段值以指定文本开头
- **结尾是**：字段值以指定文本结尾
- **不为空**：字段有值（不为空）
- **为空**：字段无值（为空）

---

## 📊 进度监控和操作控制

### 进度显示

- **进度条**：显示操作完成百分比
- **状态文本**：当前操作阶段说明
- **详细日志**：实时显示操作步骤和时间戳

### 操作控制

- **取消操作**：点击 **⏹️ 取消操作** 中止正在进行的操作
- **操作日志**：查看所有操作的详细记录和结果

---

## 💡 最佳实践建议

### 🔰 新手建议

1. **首次使用**：选择"预览差异"模式，了解工具行为
2. **小批量测试**：先用少量数据测试，确认效果后再处理全量数据
3. **备份重要数据**：操作前备份目标表格数据

### 🎯 效率提升

1. **合理选择主键**：选择唯一性好的字段作为主键，提高匹配准确性
2. **批量操作**：对于大量数据，使用"直接复制"模式提高效率
3. **筛选优化**：使用高级筛选减少不必要的数据处理

### 🛡️ 安全操作

1. **确认操作**：重要操作前仔细确认源表格和目标表格
2. **预览结果**：使用预览功能确认操作效果
3. **监控日志**：关注操作日志中的错误信息

---

## 🔧 常见问题解决

### Q1: 授权失败怎么办？

**A**:

- 检查 PersonalBaseToken 是否正确
- 确认 Token 对应的 Base 是否正确
- 重新生成 Token 并重试

### Q2: 找不到表格怎么办？

**A**:

- 确认表格 ID 格式正确（tblXXXXXX）
- 检查是否有表格访问权限
- 使用表格选择器而不是手动输入

### Q3: 字段映射不准确怎么办？

**A**:

- 使用"字段映射"模式手动调整
- 检查字段名是否完全匹配（区分大小写）
- 确认字段类型兼容性

### Q4: 复制速度慢怎么办？

**A**:

- 使用"直接复制"模式跳过分析
- 分批处理大量数据
- 检查网络连接状况

### Q5: 部分记录复制失败怎么办？

**A**:

- 查看操作日志中的错误信息
- 检查字段类型兼容性
- 确认目标表格字段配置

---

## 📋 操作检查清单

### 操作前检查

- [ ] PersonalBaseToken 已正确配置
- [ ] 源表格和目标表格 ID 正确
- [ ] 主键字段选择合适
- [ ] 操作模式符合需求
- [ ] 重要数据已备份

### 操作中监控

- [ ] 进度条正常推进
- [ ] 操作日志无错误信息
- [ ] 网络连接稳定
- [ ] 如有问题及时取消操作

### 操作后验证

- [ ] 检查复制记录数量
- [ ] 验证数据内容正确性
- [ ] 确认字段映射准确
- [ ] 查看操作日志总结

---

## 🎯 使用场景示例

### 场景 1：数据备份

```
需求：将生产环境数据备份到测试环境
方案：使用"直接复制"模式
步骤：选择生产表→选择测试表→直接复制
结果：快速创建完整数据副本
```

### 场景 2：增量同步

```
需求：定期同步主表更新到分表
方案：使用"预览差异"模式
步骤：选择主表→选择分表→预览差异→确认执行
结果：只复制变化数据，避免重复
```

### 场景 3：数据筛选

```
需求：复制特定状态的订单数据
方案：使用"高级筛选"模式
步骤：配置筛选条件（状态=已完成）→预览结果→执行复制
结果：精确获取目标数据
```

### 场景 4：结构转换

```
需求：将旧系统数据导入新系统
方案：使用"字段映射"模式
步骤：配置字段对应关系→执行映射复制
结果：完成数据格式转换
```

---

## 📞 技术支持

如果在使用过程中遇到问题，请：

1. **查看操作日志**：详细的错误信息和操作记录
2. **检查网络连接**：确保飞书服务可正常访问
3. **验证权限配置**：确认 Token 和表格访问权限
4. **参考常见问题**：查看上述 FAQ 部分

---

## 🔄 版本更新记录

### v3.0 (当前版本)

- ✅ 新增高级筛选功能
- ✅ 优化进度显示和操作控制
- ✅ 简化界面，移除重复功能
- ✅ 增强操作日志功能

### v2.0

- ✅ 新增差异分析功能
- ✅ 支持手动字段映射
- ✅ 多种操作模式

### v1.0

- ✅ 基础数据复制功能
- ✅ 动态授权支持

---

**🎉 祝您使用愉快！如有任何问题，请参考本指南或查看操作日志获取详细信息。**
